# Live2D AIåŠ©æ‰‹ é«˜çº§RAGç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ§  ç³»ç»Ÿæ¦‚è¿°

é«˜çº§RAGç³»ç»Ÿæ˜¯Live2D AIåŠ©æ‰‹çš„æ ¸å¿ƒæ™ºèƒ½æ¨¡å—ï¼Œå®ƒå°†ä¼ ç»Ÿçš„æ£€ç´¢å¢å¼ºç”ŸæˆæŠ€æœ¯æå‡åˆ°äº†ä¸€ä¸ªå…¨æ–°çš„æ°´å¹³ã€‚ç³»ç»Ÿé›†æˆäº†å›¾æ–‡æ··åˆå‘é‡åŒ–ã€çŸ¥è¯†å›¾è°±æ„å»ºã€æ™ºèƒ½å†…å®¹èåˆã€å¤šæ¨¡æ€æ¨ç†ç­‰å‰æ²¿æŠ€æœ¯ï¼Œä¸ºAIåŠ©æ‰‹æä¾›äº†æ·±åº¦ç†è§£å’Œæ¨ç†èƒ½åŠ›ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. å›¾æ–‡æ··åˆå‘é‡åŒ–
- **å¤šæ¨¡æ€å‘é‡åŒ–**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾åƒã€å›¾æ–‡æ··åˆå†…å®¹çš„ç»Ÿä¸€å‘é‡è¡¨ç¤º
- **é«˜çº§embeddingæ¨¡å‹**ï¼šä½¿ç”¨Sentence-Transformersã€CLIPç­‰å…ˆè¿›æ¨¡å‹
- **èåˆç­–ç•¥**ï¼šæ‹¼æ¥ã€å¹³å‡ã€åŠ æƒã€æ³¨æ„åŠ›ç­‰å¤šç§èåˆæ–¹å¼
- **ç¼“å­˜æœºåˆ¶**ï¼šæ™ºèƒ½ç¼“å­˜æå‡å‘é‡åŒ–æ•ˆç‡

### 2. çŸ¥è¯†å›¾è°±æ„å»º
- **å®ä½“è¯†åˆ«**ï¼šåŸºäºspaCyå’Œè§„åˆ™çš„æ··åˆå®ä½“è¯†åˆ«
- **å…³ç³»æŠ½å–**ï¼šä¾å­˜å¥æ³•åˆ†æå’Œæ¨¡å¼åŒ¹é…çš„å…³ç³»æå–
- **å›¾è°±æ„å»º**ï¼šåŠ¨æ€æ„å»ºå’Œæ›´æ–°çŸ¥è¯†å›¾è°±ç»“æ„
- **å›¾è°±å­˜å‚¨**ï¼šæ”¯æŒGraphMLã€GEXFã€JSONç­‰å¤šç§æ ¼å¼

### 3. æ™ºèƒ½å†…å®¹èåˆ
- **å¤šæºèåˆ**ï¼šæ¥è‡ªä¸åŒæ¥æºçš„ä¿¡æ¯æ™ºèƒ½æ•´åˆ
- **å†²çªè§£å†³**ï¼šåŸºäºç½®ä¿¡åº¦ã€æ—¶é—´æˆ³ã€å¤šæ•°æŠ•ç¥¨çš„å†²çªå¤„ç†
- **è´¨é‡è¯„ä¼°**ï¼šæ¥æºå¯ä¿¡åº¦ã€å†…å®¹æ–°é²œåº¦ã€å®Œæ•´æ€§è¯„ä¼°
- **èåˆç­–ç•¥**ï¼šåŠ æƒå¹³å‡ã€æ³¨æ„åŠ›æœºåˆ¶ã€å›¾ç»“æ„èåˆ

### 4. å¤šæ¨¡æ€æ¨ç†
- **è·¯å¾„æ¨ç†**ï¼šåŸºäºçŸ¥è¯†å›¾è°±çš„è·¯å¾„æŸ¥æ‰¾å’Œæ¨ç†
- **å­å›¾åŒ¹é…**ï¼šå¤æ‚æ¨¡å¼çš„å­å›¾åŒ¹é…æ¨ç†
- **éšæœºæ¸¸èµ°**ï¼šåŸºäºéšæœºæ¸¸èµ°çš„å…³è”å‘ç°
- **æ¨ç†è§£é‡Š**ï¼šå¯è§£é‡Šçš„æ¨ç†è¿‡ç¨‹å’Œç»“æœ

### 5. å›¾æŸ¥è¯¢å¤„ç†
- **è‡ªç„¶è¯­è¨€ç†è§£**ï¼šæŸ¥è¯¢æ„å›¾è¯†åˆ«å’Œå®ä½“é“¾æ¥
- **æŸ¥è¯¢ä¼˜åŒ–**ï¼šæŸ¥è¯¢é‡å†™ã€åˆ†è§£å’Œå¹¶è¡Œæ‰§è¡Œ
- **ç»“æœæ’åº**ï¼šå¤šå› å­çš„ç»“æœæ’åºå’Œè¿‡æ»¤
- **æŸ¥è¯¢ç¼“å­˜**ï¼šé«˜æ•ˆçš„æŸ¥è¯¢ç»“æœç¼“å­˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç³»ç»Ÿè¦æ±‚
```bash
# æ ¸å¿ƒä¾èµ–
pip install networkx sentence-transformers scikit-learn spacy

# å¯é€‰ä¾èµ–ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
pip install matplotlib plotly pyvis transformers torch

# spaCyä¸­æ–‡æ¨¡å‹
python -m spacy download zh_core_web_sm
```

### 2. å¯åŠ¨ç³»ç»Ÿ
```bash
# æµ‹è¯•é«˜çº§RAGç³»ç»Ÿ
python test_advanced_rag_system.py

# å¯åŠ¨å®Œæ•´æœåŠ¡
python server.py
```

### 3. å‰ç«¯ä½¿ç”¨
1. è®¿é—® `http://localhost:5000`
2. åœ¨"ğŸ§  é«˜çº§RAGç³»ç»Ÿ"é¢æ¿å¯ç”¨åŠŸèƒ½
3. è¿›è¡Œæ–‡æ¡£å¤„ç†ã€é«˜çº§æŸ¥è¯¢ã€å¤šæ¨¡æ€æ¨ç†ç­‰æ“ä½œ

## ğŸ“Š ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
AdvancedRAGManager (ç®¡ç†å™¨)
â”œâ”€â”€ MultimodalVectorizer (å‘é‡åŒ–å™¨)
â”œâ”€â”€ KnowledgeGraphBuilder (å›¾è°±æ„å»ºå™¨)
â”œâ”€â”€ ContentFusionEngine (èåˆå¼•æ“)
â”œâ”€â”€ MultimodalReasoningEngine (æ¨ç†å¼•æ“)
â””â”€â”€ GraphQueryProcessor (æŸ¥è¯¢å¤„ç†å™¨)
```

### æ•°æ®æµç¨‹

1. **æ–‡æ¡£è¾“å…¥** â†’ å‘é‡åŒ– + å›¾è°±æ„å»º
2. **æŸ¥è¯¢è¾“å…¥** â†’ æ„å›¾ç†è§£ + å›¾æŸ¥è¯¢ + æ¨ç†
3. **å¤šæºç»“æœ** â†’ å†…å®¹èåˆ + ç­”æ¡ˆç”Ÿæˆ
4. **ç»“æœè¾“å‡º** â†’ æ’åºè¿‡æ»¤ + å¯è§£é‡Šæ€§

## ğŸ”§ APIæ¥å£è¯¦è§£

### ç³»ç»ŸçŠ¶æ€æ¥å£
```http
GET /api/advanced-rag/status
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "available": true,
    "status": {
        "is_active": true,
        "processing_stats": {
            "documents_processed": 25,
            "queries_processed": 150,
            "reasoning_requests": 45
        },
        "knowledge_graph_stats": {
            "nodes": 1250,
            "edges": 3400,
            "density": 0.0043
        }
    }
}
```

### é«˜çº§æ–‡æ¡£å¤„ç†
```http
POST /api/advanced-rag/process-document
Content-Type: application/json

{
    "text": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯...",
    "doc_id": "ai_intro_001",
    "image_path": "/path/to/image.jpg",
    "metadata": {
        "source": "academic_paper",
        "author": "å¼ ä¸‰"
    }
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "success": true,
    "doc_id": "ai_intro_001",
    "processing_steps": [
        "å‘é‡åŒ–å®Œæˆ",
        "çŸ¥è¯†å›¾è°±æ„å»ºå®Œæˆ",
        "å¤šæ¨¡æ€å¤„ç†å®Œæˆ"
    ],
    "vectorization": {
        "type": "multimodal",
        "dimension": 384
    },
    "knowledge_graph": {
        "entities_added": 15,
        "relations_added": 8
    }
}
```

### é«˜çº§æŸ¥è¯¢
```http
POST /api/advanced-rag/query
Content-Type: application/json

{
    "query": "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
    "query_type": "auto",
    "max_results": 10,
    "include_reasoning": true
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "success": true,
    "query": "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
    "graph_query_results": [...],
    "reasoning_results": {
        "answer": "æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯...",
        "confidence": 0.85,
        "paths": [...]
    },
    "fused_answer": "åŸºäºå¤šæºä¿¡æ¯èåˆçš„ç»¼åˆç­”æ¡ˆ...",
    "confidence": 0.82,
    "sources": ["graph_query", "reasoning_engine", "basic_rag"]
}
```

### å¤šæ¨¡æ€æ¨ç†
```http
POST /api/advanced-rag/reasoning
Content-Type: application/json

{
    "query": "äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ çš„å…³ç³»",
    "reasoning_type": "path_based",
    "image_path": "/path/to/diagram.jpg"
}
```

### å›¾æŸ¥è¯¢
```http
POST /api/advanced-rag/graph-query
Content-Type: application/json

{
    "query": "åŒ—äº¬å’Œä¸­å›½çš„å…³ç³»"
}
```

### é«˜çº§å‘é‡åŒ–
```http
POST /api/advanced-rag/vectorize
Content-Type: application/json

{
    "text": "æµ‹è¯•æ–‡æœ¬å†…å®¹",
    "image_path": "/path/to/image.jpg",
    "fusion_strategy": "attention"
}
```

## âš™ï¸ é…ç½®å’Œè‡ªå®šä¹‰

### å‘é‡åŒ–é…ç½®
```python
VECTORIZER_CONFIG = {
    "text_model": "paraphrase-multilingual-MiniLM-L12-v2",
    "image_model": "clip-ViT-B-32",
    "embedding_dimension": 384,
    "max_sequence_length": 512,
    "batch_size": 32,
    "cache_embeddings": True
}
```

### çŸ¥è¯†å›¾è°±é…ç½®
```python
KNOWLEDGE_GRAPH_CONFIG = {
    "graph_type": GraphType.DIRECTED,
    "max_nodes": 100000,
    "entity_extraction": {
        "model": "zh_core_web_sm",
        "confidence_threshold": 0.8
    },
    "relation_extraction": {
        "confidence_threshold": 0.7
    }
}
```

### æ¨ç†é…ç½®
```python
REASONING_CONFIG = {
    "default_reasoning": "path_based",
    "path_finding": {
        "max_depth": 5,
        "max_paths": 10,
        "algorithm": "dijkstra"
    },
    "confidence_calculation": {
        "factors": ["path_length", "edge_weights", "node_importance"],
        "weights": [0.2, 0.3, 0.2]
    }
}
```

### èåˆé…ç½®
```python
CONTENT_FUSION_CONFIG = {
    "default_strategy": "attention_based",
    "conflict_resolution": {
        "strategy": "confidence_based",
        "threshold": 0.1
    },
    "quality_assessment": {
        "factors": ["source_credibility", "content_freshness"],
        "weights": [0.3, 0.2]
    }
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. å­¦æœ¯ç ”ç©¶
- **æ–‡çŒ®åˆ†æ**ï¼šè‡ªåŠ¨æå–è®ºæ–‡ä¸­çš„å®ä½“å’Œå…³ç³»
- **çŸ¥è¯†å‘ç°**ï¼šé€šè¿‡å›¾è°±æ¨ç†å‘ç°éšè—çš„çŸ¥è¯†è”ç³»
- **å¤šæºæ•´åˆ**ï¼šèåˆæ¥è‡ªä¸åŒæ–‡çŒ®çš„ä¿¡æ¯
- **å‡è®¾éªŒè¯**ï¼šåŸºäºçŸ¥è¯†å›¾è°±éªŒè¯ç ”ç©¶å‡è®¾

### 2. ä¼ä¸šçŸ¥è¯†ç®¡ç†
- **æ–‡æ¡£æ™ºèƒ½åŒ–**ï¼šå°†ä¼ä¸šæ–‡æ¡£è½¬åŒ–ä¸ºç»“æ„åŒ–çŸ¥è¯†
- **ä¸“å®¶ç³»ç»Ÿ**ï¼šæ„å»ºé¢†åŸŸä¸“å®¶çŸ¥è¯†å›¾è°±
- **å†³ç­–æ”¯æŒ**ï¼šåŸºäºå¤šæºä¿¡æ¯çš„æ™ºèƒ½å†³ç­–
- **çŸ¥è¯†ä¼ æ‰¿**ï¼šå°†ä¸“å®¶ç»éªŒè½¬åŒ–ä¸ºå¯æŸ¥è¯¢çš„çŸ¥è¯†åº“

### 3. æ•™è‚²åŸ¹è®­
- **ä¸ªæ€§åŒ–å­¦ä¹ **ï¼šæ ¹æ®å­¦ä¹ è€…ç‰¹ç‚¹æ¨èå­¦ä¹ è·¯å¾„
- **çŸ¥è¯†å›¾è°±æ•™å­¦**ï¼šå¯è§†åŒ–çŸ¥è¯†ç»“æ„å’Œå…³è”
- **æ™ºèƒ½ç­”ç–‘**ï¼šåŸºäºæ¨ç†çš„æ·±åº¦é—®ç­”
- **å­¦ä¹ è¯„ä¼°**ï¼šå¤šç»´åº¦çš„å­¦ä¹ æ•ˆæœè¯„ä¼°

### 4. æ™ºèƒ½å®¢æœ
- **å¤æ‚é—®é¢˜å¤„ç†**ï¼šé€šè¿‡æ¨ç†è§£å†³å¤æ‚ä¸šåŠ¡é—®é¢˜
- **å¤šè½®å¯¹è¯**ï¼šåŸºäºä¸Šä¸‹æ–‡çš„è¿ç»­å¯¹è¯
- **çŸ¥è¯†æ›´æ–°**ï¼šåŠ¨æ€æ›´æ–°ä¸šåŠ¡çŸ¥è¯†åº“
- **ä¸ªæ€§åŒ–æœåŠ¡**ï¼šåŸºäºç”¨æˆ·ç”»åƒçš„ä¸ªæ€§åŒ–å›ç­”

## ğŸ” é«˜çº§åŠŸèƒ½

### 1. å›¾è°±å¯è§†åŒ–
```python
# ä½¿ç”¨NetworkXå’ŒMatplotlibå¯è§†åŒ–
import matplotlib.pyplot as plt
import networkx as nx

def visualize_graph(kg_builder):
    graph = kg_builder.graph
    pos = nx.spring_layout(graph)
    nx.draw(graph, pos, with_labels=True)
    plt.show()
```

### 2. è‡ªå®šä¹‰å®ä½“ç±»å‹
```python
from advanced_rag_system.advanced_rag_config import EntityType

# æ·»åŠ è‡ªå®šä¹‰å®ä½“ç±»å‹
class CustomEntityType(EntityType):
    PRODUCT = "product"
    TECHNOLOGY = "technology"
    PROCESS = "process"
```

### 3. è‡ªå®šä¹‰æ¨ç†ç­–ç•¥
```python
class CustomReasoningEngine(MultimodalReasoningEngine):
    def custom_reasoning(self, query, entities):
        # å®ç°è‡ªå®šä¹‰æ¨ç†é€»è¾‘
        pass
```

### 4. æ€§èƒ½ä¼˜åŒ–
```python
# å¯ç”¨GPUåŠ é€Ÿ
VECTORIZER_CONFIG["device"] = "cuda"

# è°ƒæ•´æ‰¹å¤„ç†å¤§å°
VECTORIZER_CONFIG["batch_size"] = 64

# å¯ç”¨å¹¶è¡Œå¤„ç†
PERFORMANCE_CONFIG["parallel_processing"]["enabled"] = True
PERFORMANCE_CONFIG["parallel_processing"]["max_workers"] = 8
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å‘é‡åŒ–å¤±è´¥**
   - æ£€æŸ¥sentence-transformersæ˜¯å¦æ­£ç¡®å®‰è£…
   - ç¡®è®¤æ¨¡å‹æ–‡ä»¶æ˜¯å¦ä¸‹è½½å®Œæ•´
   - éªŒè¯è¾“å…¥æ–‡æœ¬æ ¼å¼æ˜¯å¦æ­£ç¡®

2. **å›¾è°±æ„å»ºå¤±è´¥**
   - æ£€æŸ¥spaCyæ¨¡å‹æ˜¯å¦å®‰è£…
   - ç¡®è®¤NetworkXç‰ˆæœ¬å…¼å®¹æ€§
   - éªŒè¯æ–‡æœ¬ç¼–ç æ ¼å¼

3. **æ¨ç†ç»“æœä¸å‡†ç¡®**
   - è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼
   - å¢åŠ è®­ç»ƒæ•°æ®
   - ä¼˜åŒ–å®ä½“è¯†åˆ«è§„åˆ™

4. **æ€§èƒ½é—®é¢˜**
   - å¯ç”¨ç¼“å­˜æœºåˆ¶
   - è°ƒæ•´æ‰¹å¤„ç†å¤§å°
   - ä½¿ç”¨GPUåŠ é€Ÿ

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è¯¦ç»†æ—¥å¿—**
   ```python
   import logging
   logging.basicConfig(level=logging.DEBUG)
   ```

2. **ä½¿ç”¨æµ‹è¯•è„šæœ¬**
   ```bash
   python test_advanced_rag_system.py
   ```

3. **ç›‘æ§APIå“åº”**
   ```bash
   curl -X GET http://localhost:5000/api/advanced-rag/status
   ```

4. **æ£€æŸ¥å›¾è°±ç»Ÿè®¡**
   ```bash
   curl -X GET http://localhost:5000/api/advanced-rag/graph-stats
   ```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. å‘é‡åŒ–ä¼˜åŒ–
- ä½¿ç”¨æ›´é«˜æ•ˆçš„embeddingæ¨¡å‹
- å¯ç”¨å‘é‡ç¼“å­˜æœºåˆ¶
- æ‰¹é‡å¤„ç†æ–‡æœ¬
- GPUåŠ é€Ÿè®¡ç®—

### 2. å›¾è°±ä¼˜åŒ–
- é™åˆ¶å›¾è°±å¤§å°
- ä½¿ç”¨å›¾æ•°æ®åº“å­˜å‚¨
- å®æ–½å›¾è°±å‹ç¼©
- ä¼˜åŒ–æŸ¥è¯¢ç®—æ³•

### 3. æ¨ç†ä¼˜åŒ–
- é™åˆ¶æ¨ç†æ·±åº¦
- ä½¿ç”¨å¯å‘å¼å‰ªæ
- ç¼“å­˜æ¨ç†ç»“æœ
- å¹¶è¡Œæ¨ç†å¤„ç†

### 4. èåˆä¼˜åŒ–
- é¢„è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µ
- ä½¿ç”¨è¿‘ä¼¼ç®—æ³•
- é™åˆ¶èåˆæºæ•°é‡
- å¼‚æ­¥å¤„ç†æœºåˆ¶

## ğŸš€ æœªæ¥æ‰©å±•

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- **ç¥ç»ç¬¦å·æ¨ç†**ï¼šç»“åˆç¥ç»ç½‘ç»œå’Œç¬¦å·æ¨ç†
- **æ—¶åºçŸ¥è¯†å›¾è°±**ï¼šæ”¯æŒæ—¶é—´ç»´åº¦çš„çŸ¥è¯†è¡¨ç¤º
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ‰©å±•åˆ°æ›´å¤šè¯­è¨€çš„å¤„ç†
- **è”é‚¦å­¦ä¹ **ï¼šåˆ†å¸ƒå¼çŸ¥è¯†å›¾è°±æ„å»º

### é«˜çº§é›†æˆ
- **å¤–éƒ¨çŸ¥è¯†åº“**ï¼šé›†æˆWikidataã€DBpediaç­‰
- **å®æ—¶æ›´æ–°**ï¼šæ”¯æŒçŸ¥è¯†å›¾è°±çš„å®æ—¶æ›´æ–°
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šçŸ¥è¯†å›¾è°±çš„ç‰ˆæœ¬ç®¡ç†
- **åä½œç¼–è¾‘**ï¼šå¤šç”¨æˆ·åä½œæ„å»ºçŸ¥è¯†å›¾è°±

---

é€šè¿‡è¿™ä¸ªé«˜çº§RAGç³»ç»Ÿï¼Œæ‚¨çš„Live2D AIåŠ©æ‰‹å°†å…·å¤‡çœŸæ­£çš„æ·±åº¦ç†è§£å’Œæ¨ç†èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„å¤šæ¨¡æ€ä¿¡æ¯ï¼Œå¹¶æä¾›å‡†ç¡®ã€å¯è§£é‡Šçš„æ™ºèƒ½å›ç­”ï¼ ğŸ§ âœ¨
